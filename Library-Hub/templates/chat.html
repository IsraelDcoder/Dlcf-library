{% extends "base.html" %}

{% block title %}Chat — DLCF AI Assistant{% endblock %}

{% block extra_css %}
<style>
.page-container { max-width:980px; margin: 30px auto; padding: 18px; }
.chat-panel { border-radius:12px; background: var(--surface); padding: 18px; box-shadow: var(--card-shadow); display:flex; flex-direction:column; gap:12px; }
.chat-messages { min-height: 220px; max-height: 440px; overflow-y:auto; padding:12px; border-radius:8px; background: linear-gradient(180deg, rgba(245,247,255,1), rgba(238,243,255,1)); }
.msg { padding:10px 12px; border-radius:10px; margin-bottom:8px; max-width:78%; }
.msg.user { background: linear-gradient(90deg,#1d4ed8,#2563eb); color:#fff; margin-left:auto; }
.msg.ai { background: rgba(15,23,42,0.06); color:var(--text-color); }
#chatInput { width:100%; min-height:56px; padding:10px; border-radius:10px; border:1px solid var(--border-color); resize:vertical; }
.chat-form { display:flex; gap:10px; align-items:flex-end; }
</style>
{% endblock %}

{% block content %}
<div class="page-container">
  <h1>Ask our AI Assistant</h1>
  <p class="muted">Ask for resource suggestions, study plans, or clarifications about materials in the library. This is a simple assistant to help you find and use resources.</p>

  <div class="chat-panel">
    <div id="messages" class="chat-messages" aria-live="polite"></div>

    <form id="chatForm" class="chat-form" onsubmit="return false;">
      <textarea id="chatInput" placeholder="Type your question or request..." required></textarea>
      <button id="chatSend" class="btn btn-primary">Send</button>
    </form>
    <div class="muted" style="font-size:0.9rem">Note: This assistant provides guidance and quick suggestions only.</div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('chatForm');
  const input = document.getElementById('chatInput');
  const messages = document.getElementById('messages');

  function appendMessage(text, cls) {
    const el = document.createElement('div');
    el.className = 'msg ' + cls;
    el.textContent = text;
    messages.appendChild(el);
    messages.scrollTop = messages.scrollHeight;
  }

  form.addEventListener('submit', function(e) {
    const value = input.value.trim();
    if (!value) return;
    appendMessage(value, 'user');
    input.value = '';
    // Fake AI response (placeholder). Replace with real API call later.
    setTimeout(() => {
      appendMessage('Thanks — I found a few resources that may help. Try browsing "Bible study" or "daily devotionals" in the library for curated collections.', 'ai');
    }, 800);
  });
});
</script>
{% endblock %}